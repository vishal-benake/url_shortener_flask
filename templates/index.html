{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-md-6">
    <h2 class="mb-3 text-center">Shorten Your URL</h2>
    <form method="POST">
      <div class="mb-3">
        <input type="url" class="form-control" name="target_url" placeholder="Enter a valid URL (https://example.com)" required>
      </div>
      <button type="submit" class="btn btn-primary w-100">Shorten</button>
    </form>

    {% if short_url %}
    <div class="card mt-4 shadow-sm border-primary" id="short-card">
      <div class="card-body d-flex justify-content-between align-items-center">
        <span id="short-url" class="fw-bold text-truncate" style="max-width: 80%;">{{ short_url }}</span>
        <button class="btn btn-outline-success btn-sm" id="copy-btn">
          <i class="bi bi-clipboard"></i> Copy
        </button>
      </div>
    </div>
    {% endif %}
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const copyBtn = document.getElementById('copy-btn');
  if (!copyBtn) return;
  copyBtn.addEventListener('click', function() {
    const span = document.getElementById('short-url');
    navigator.clipboard.writeText(span.innerText).then(() => {
      showToast('Copied: ' + span.innerText, 'success', 2000);
      // hide the card gracefully
      const card = document.getElementById('short-card');
      if (!card) return;
      card.classList.add('fade-out');
      setTimeout(() => card.remove(), 600);
    });
  });
});
</script>

<style>
/* fade out animation */
.fade-out {
  animation: fadeOut 0.6s ease forwards;
}
@keyframes fadeOut {
  from { opacity: 1; transform: translateY(0px); }
  to { opacity: 0; transform: translateY(-8px); }
}
</style>
{% endblock %}
